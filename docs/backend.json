{
  "entities": {
    "InstructorProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InstructorProfile",
      "type": "object",
      "description": "Represents the professional profile of an instructor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the InstructorProfile entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User entity. (Relationship: User 1:1 InstructorProfile)"
        },
        "name": {
          "type": "string",
          "description": "The full name of the instructor."
        },
        "bio": {
          "type": "string",
          "description": "A short biography or description of the instructor."
        },
        "expertise": {
          "type": "string",
          "description": "Instructor's area of expertise or specialization."
        },
        "certifications": {
          "type": "array",
          "description": "List of certifications held by the instructor.",
          "items": {
            "type": "string"
          }
        },
        "profileImageUrl": {
          "type": "string",
          "description": "URL to the instructor's profile image.",
          "format": "uri"
        },
        "contactEmail": {
          "type": "string",
          "description": "Contact email address for the instructor.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "userId",
        "name",
        "bio",
        "expertise"
      ]
    },
    "Class": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Class",
      "type": "object",
      "description": "Represents a class offered by an instructor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Class entity."
        },
        "instructorId": {
          "type": "string",
          "description": "Reference to the InstructorProfile entity. (Relationship: InstructorProfile 1:N Class)"
        },
        "name": {
          "type": "string",
          "description": "The name of the class."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the class."
        },
        "schedule": {
          "type": "string",
          "description": "The schedule of the class (e.g., days, times)."
        },
        "price": {
          "type": "number",
          "description": "The price of the class."
        },
        "availability": {
          "type": "number",
          "description": "The number of available slots in the class."
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates whether the class is currently active."
        },
        "category": {
          "type": "string",
          "description": "The category of the class (e.g., art, sports, health)."
        }
      },
      "required": [
        "id",
        "instructorId",
        "name",
        "description",
        "schedule",
        "price",
        "availability",
        "isActive",
        "category"
      ]
    },
    "Booking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Booking",
      "type": "object",
      "description": "Represents a booking for a class.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Booking entity."
        },
        "classId": {
          "type": "string",
          "description": "Reference to the Class entity. (Relationship: Class 1:N Booking)"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User entity. (Relationship: User 1:N Booking)"
        },
        "bookingDate": {
          "type": "string",
          "description": "The date and time the booking was made.",
          "format": "date-time"
        },
        "attendanceStatus": {
          "type": "string",
          "description": "The attendance status of the user for the booked class (e.g., attended, missed)."
        }
      },
      "required": [
        "id",
        "classId",
        "userId",
        "bookingDate",
        "attendanceStatus"
      ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification sent to an instructor or user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Notification entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User entity. (Relationship: User 1:N Notification)"
        },
        "message": {
          "type": "string",
          "description": "The content of the notification."
        },
        "timestamp": {
          "type": "string",
          "description": "The date and time the notification was sent.",
          "format": "date-time"
        },
        "type": {
          "type": "string",
          "description": "The type of notification (e.g., booking, reminder, update)."
        },
        "isRead": {
          "type": "boolean",
          "description": "Indicates whether the notification has been read."
        }
      },
      "required": [
        "id",
        "userId",
        "message",
        "timestamp",
        "type",
        "isRead"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application (instructor or student).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "fullName": {
          "type": "string",
          "description": "The user's full name."
        },
        "isInstructor": {
          "type": "boolean",
          "description": "Indicates whether the user is an instructor."
        }
      },
      "required": [
        "id",
        "email",
        "fullName",
        "isInstructor"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user information. Path-based ownership ensures only the user can access their own data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/instructors/{instructorId}",
        "definition": {
          "entityName": "InstructorProfile",
          "schema": {
            "$ref": "#/backend/entities/InstructorProfile"
          },
          "description": "Stores instructor profiles. Path-based ownership ensures only the instructor or admin can manage the profile.",
          "params": [
            {
              "name": "instructorId",
              "description": "The unique identifier of the instructor."
            }
          ]
        }
      },
      {
        "path": "/instructors/{instructorId}/classes/{classId}",
        "definition": {
          "entityName": "Class",
          "schema": {
            "$ref": "#/backend/entities/Class"
          },
          "description": "Stores classes offered by instructors. Nested under instructor ID for clear ownership.",
          "params": [
            {
              "name": "instructorId",
              "description": "The unique identifier of the instructor."
            },
            {
              "name": "classId",
              "description": "The unique identifier of the class."
            }
          ]
        }
      },
      {
        "path": "/classes/{classId}/bookings/{bookingId}",
        "definition": {
          "entityName": "Booking",
          "schema": {
            "$ref": "#/backend/entities/Booking"
          },
          "description": "Stores bookings for classes. Nested under class ID for efficient queries and management.",
          "params": [
            {
              "name": "classId",
              "description": "The unique identifier of the class."
            },
            {
              "name": "bookingId",
              "description": "The unique identifier of the booking."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/bookings/{bookingId}",
        "definition": {
          "entityName": "Booking",
          "schema": {
            "$ref": "#/backend/entities/Booking"
          },
          "description": "Duplicate of booking for classes. Nested under user ID for efficient queries and management.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "bookingId",
              "description": "The unique identifier of the booking."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/notifications/{notificationId}",
        "definition": {
          "entityName": "Notification",
          "schema": {
            "$ref": "#/backend/entities/Notification"
          },
          "description": "Stores notifications for users. Nested under user ID to easily fetch notifications for a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "notificationId",
              "description": "The unique identifier of the notification."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure authorization independence, clarity, and scalability, adhering to the specified principles. User profiles and related data are segregated under the `/users/{userId}` path for private data. Instructor profiles are stored separately to allow for independent management. Classes are also nested under the instructor's profile to maintain ownership, and bookings are nested under both user and class to support efficient queries and denormalization. Notifications are segregated under user to allow list operation for specific user.\n\n*   **Authorization Independence:** Achieved through path-based ownership for user-specific data and explicit instructorId on classes and bookings. The `instructorId` field in the `classes` collection allows us to determine the instructor owning the class without needing to read the instructor profile document. The `userId` and `classId` fields in the `bookings` collection provide authorization context for bookings without needing to `get()` the parent documents.\n*   **QAPs:** Secure `list` operations are supported by segregating data based on ownership. For example, listing classes is performed under `/instructors/{instructorId}/classes`, which restricts access to classes owned by a specific instructor. Listing bookings can be performed under `/users/{userId}/bookings` to get bookings related to a user, or under `/classes/{classId}/bookings` to get bookings for the class.\n*   **Data Clarity and Predictability:** The structure utilizes explicit state modeling through boolean fields like `isActive` in classes, avoiding the need to infer state. Predictable schema is enforced by using static keys and avoiding dynamic keys. Standardized naming conventions are applied (e.g., `userId`, `instructorId`)."
  }
}