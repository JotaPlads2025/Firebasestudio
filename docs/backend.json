
{
  "entities": {
    "InstructorProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InstructorProfile",
      "type": "object",
      "description": "Represents the professional profile of an instructor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the instructor profile."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User entity. (Relationship: User 1:1 InstructorProfile)"
        },
        "name": {
          "type": "string",
          "description": "Instructor's professional or full name."
        },
        "bio": {
          "type": "string",
          "description": "A short biography of the instructor."
        },
        "category": {
          "type": "string",
          "description": "The main category of expertise (e.g., Baile, Deporte)."
        },
        "styles": {
          "type": "array",
          "description": "A list of specific styles the instructor teaches.",
          "items": {
            "type": "string"
          }
        },
        "audiences": {
          "type": "array",
          "description": "The target audiences for the classes (e.g., Lady Style, Mixto).",
          "items": {
            "type": "string"
          }
        },
        "isCoaching": {
          "type": "boolean",
          "description": "Indicates if the instructor offers private coaching."
        },
        "profilePictureUrl": {
          "type": "string",
          "description": "URL of the instructor's profile picture.",
          "format": "uri"
        },
        "contactEmail": {
          "type": "string",
          "description": "Instructor's contact email address.",
          "format": "email"
        },
        "instagramUrl": {
          "type": "string",
          "format": "uri",
          "description": "URL to the instructor's Instagram profile."
        },
        "tiktokUrl": {
          "type": "string",
          "format": "uri",
          "description": "URL to the instructor's TikTok profile."
        },
        "facebookUrl": {
          "type": "string",
          "format": "uri",
          "description": "URL to the instructor's Facebook profile."
        },
        "linkedinUrl": {
          "type": "string",
          "format": "uri",
          "description": "URL to the instructor's LinkedIn profile."
        },
        "websiteUrl": {
          "type": "string",
          "format": "uri",
          "description": "URL to the instructor's personal or professional website."
        },
        "stats": {
            "type": "object",
            "description": "Aggregated statistics for the instructor.",
            "properties": {
                "totalStudents": { "type": "number" },
                "totalRevenue": { "type": "number" },
                "totalBookings": { "type": "number" }
            }
        }
      },
      "required": [
        "id",
        "userId",
        "name"
      ]
    },
    "Class": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Class",
      "type": "object",
      "description": "Represents a class offered by an instructor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the class."
        },
        "instructorId": {
          "type": "string",
          "description": "Reference to InstructorProfile. (Relationship: InstructorProfile 1:N Class)"
        },
        "instructorName": {
            "type": "string",
            "description": "Denormalized name of the instructor for quick display."
        },
        "instructorAvatar": {
            "type": "string",
            "format": "uri",
            "description": "Denormalized URL of the instructor's avatar for quick display."
        },
        "name": {
          "type": "string",
          "description": "Name of the class."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the class."
        },
        "schedule": {
          "type": "string",
          "description": "Scheduling details for the class (e.g., days, times)."
        },
        "price": {
          "type": "number",
          "description": "Price of the class."
        },
        "availability": {
          "type": "number",
          "description": "Number of available slots in the class."
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates whether the class is currently active."
        },
        "level": {
          "type": "string"
        },
        "subCategory": {
          "type": "string"
        },
        "stats": {
            "type": "object",
            "description": "Aggregated statistics for the class.",
            "properties": {
                "totalBookings": { "type": "number" },
                "totalRevenue": { "type": "number" },
                "occupancyRate": { "type": "number" }
            }
        }
      },
      "required": [
        "id",
        "instructorId",
        "name",
        "description",
        "schedule",
        "price",
        "availability",
        "isActive"
      ]
    },
    "Booking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Booking",
      "type": "object",
      "description": "Represents a student's booking for a class.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the booking."
        },
        "classId": {
          "type": "string",
          "description": "Reference to the Class."
        },
        "className": {
            "type": "string",
            "description": "Denormalized name of the class for quick display."
        },
        "classLevel": {
            "type": "string",
            "description": "Denormalized level of the class."
        },
        "instructorId": {
            "type": "string",
            "description": "Reference to the instructor of the class."
        },
        "studentId": {
          "type": "string",
          "description": "Reference to the student (User)."
        },
        "studentName": {
            "type": "string",
            "description": "Denormalized name of the student for quick display."
        },
        "bookingDate": {
          "type": "string",
          "description": "Date and time when the booking was made.",
          "format": "date-time"
        },
        "classDate": {
            "type": "string",
            "description": "The specific date of the class being booked.",
            "format": "date-time"
        },
        "attendanceStatus": {
          "type": "string",
          "description": "Attendance status of the student for the class (e.g., Attended, Absent).",
          "enum": ["Confirmada", "Asisti√≥", "Ausente", "Cancelada"]
        }
      },
      "required": [
        "id",
        "classId",
        "instructorId",
        "studentId",
        "bookingDate",
        "classDate",
        "attendanceStatus"
      ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification sent to an instructor or student.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the notification."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User that the notification is for. (Relationship: User 1:N Notification)"
        },
        "type": {
          "type": "string",
          "description": "Type of notification (e.g., New booking, Class reminder)."
        },
        "message": {
          "type": "string",
          "description": "Content of the notification."
        },
        "sentAt": {
          "type": "string",
          "description": "Date and time when the notification was sent.",
          "format": "date-time"
        },
        "isRead": {
          "type": "boolean",
          "description": "Indicates whether the notification has been read."
        }
      },
      "required": [
        "id",
        "userId",
        "type",
        "message",
        "sentAt",
        "isRead"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application (either an instructor or a student).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "role": {
          "type": "string",
          "description": "The role of the user, e.g., 'instructor' or 'student'."
        }
      },
      "required": [
        "id",
        "email",
        "firstName",
        "lastName",
        "role"
      ]
    },
    "Venue": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Venue",
      "type": "object",
      "description": "Represents a physical location where classes are held.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the venue."
        },
        "ownerId": {
          "type": "string",
          "description": "The user ID of the instructor who owns this venue."
        },
        "name": {
          "type": "string",
          "description": "The name of the venue."
        },
        "address": {
          "type": "string",
          "description": "The street address of the venue."
        },
        "region": {
          "type": "string",
          "description": "The region where the venue is located."
        },
        "commune": {
          "type": "string",
          "description": "The commune where the venue is located."
        }
      },
      "required": [
        "id",
        "ownerId",
        "name",
        "address",
        "region",
        "commune"
      ]
    }
  },
  "auth": {
    "providers": [
      "google"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user information. Each user document is uniquely identified by its userId.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/instructorProfile/{profileId}",
        "definition": {
          "entityName": "InstructorProfile",
          "schema": {
            "$ref": "#/backend/entities/InstructorProfile"
          },
          "description": "Stores the instructor profile information, as a subcollection under the user. Using a fixed document ID like 'profile' is recommended for a 1:1 relationship.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user (also the instructor)."
            },
            {
              "name": "profileId",
              "description": "Unique identifier for the profile document (e.g., a fixed string 'profile')."
            }
          ]
        }
      },
      {
        "path": "/classes/{classId}",
        "definition": {
          "entityName": "Class",
          "schema": {
            "$ref": "#/backend/entities/Class"
          },
          "description": "Root collection for all classes. This allows for efficient global queries and filtering. Each class document contains a reference to its instructor via 'instructorId'.",
          "params": [
            {
              "name": "classId",
              "description": "Unique identifier for the class."
            }
          ]
        }
      },
      {
        "path": "/bookings/{bookingId}",
        "definition": {
          "entityName": "Booking",
          "schema": {
            "$ref": "#/backend/entities/Booking"
          },
          "description": "Root collection for all bookings. This flat structure simplifies querying bookings by user, instructor, or class. Each document contains denormalized data for performance.",
          "params": [
            {
              "name": "bookingId",
              "description": "Unique identifier for the booking."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/notifications/{notificationId}",
        "definition": {
          "entityName": "Notification",
          "schema": {
            "$ref": "#/backend/entities/Notification"
          },
          "description": "Stores notifications for each user.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            },
            {
              "name": "notificationId",
              "description": "Unique identifier for the notification."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/venues/{venueId}",
        "definition": {
          "entityName": "Venue",
          "schema": {
            "$ref": "#/backend/entities/Venue"
          },
          "description": "Stores venues created by instructors. Each instructor can manage their own list of venues.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user (instructor)."
            },
            {
              "name": "venueId",
              "description": "Unique identifier for the venue."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed with a flat hierarchy for scalability and query efficiency. '/classes' and '/bookings' are root collections, enabling global searches and filters without deep nesting. Data is strategically denormalized (e.g., instructorName in Class, className in Booking) to reduce the need for complex joins and improve read performance. Subcollections are used only for data strictly owned by a user, such as notifications, venues, and instructor-specific profiles, simplifying security rules."
  }
}

    